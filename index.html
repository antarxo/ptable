<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Περιοδικός Πίνακας – Τελική Έκδοση</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
  <style>
    /* Βασικές ρυθμίσεις */
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      overflow: hidden;
      background: #f7f7f7;
    }
    /* Τίτλος */
    #title {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 24px;
      font-weight: bold;
      z-index: 50;
    }
    /* Info Panel - Αυτό το div εμφανίζεται με διαφορετικές παραμέτρους ανά view */
    #infoPanel {
      background: rgba(255,255,255,0.95);
      border: 2px solid #333;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      padding: 20px;
      position: absolute;
      z-index: 40;
      transition: all 1.5s ease;
    }
    /* Full view: infoPanel.top = 500px, left = 20px, width = W - 210px (πλάτος κουμπιών 150px + 60px επιπλέον) */
    body.full #infoPanel {
      top: 500px;
      left: 20px;
      width: calc(100vw - 210px);
    }
    /* Collapsed view: infoPanel.top = 100px, left = (p.right + 42) και width = W - 888px, όπου p.right υπολογίζεται ως 554 + 252 = 806px */
    body.collapsed #infoPanel {
      top: 100px;
      left: calc(806px + 42px); /* 848px */
      width: calc(100vw - 888px);
      height: 300px;
      /* Στη διάταξη collapsed, το infoPanel θα εμφανίζεται ως column (αν χρειάζεται) – εδώ διατηρούμε την υπάρχουσα διάταξη */
    }
    /* Εσωτερικά τμήματα του infoPanel: διαιρούμενο σε δύο "κελία" */
    #leftPanel, #middlePanel {
      padding: 5px;
      width: 50%;
    }
    /* Fixed κουμπιά στο #rightPanel: Σταθερό στην κάτω δεξιά γωνία της οθόνης */
    #rightPanel {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 150px;
      display: flex;
      flex-direction: column;
      gap: 5px;
      z-index: 100;
    }
    /* Καμβάδες τομέων - βασική διαμόρφωση */
    .canvas {
      position: absolute;
      background: transparent;
      transition: all 1s ease-in-out;
      transform: translateY(-10px);
    }
    /* FULL VIEW: Θέσεις κύριων καμβάδων */
    #canvasS {
      left: 50px;
      top: 100px;
      width: 84px;
      height: 294px;
      background: #ffcccc;
      z-index: 1;
    }
    #canvasF {
      left: 134px;
      top: 100px;
      width: 588px;
      height: 294px;
      background: #ffe5cc;
      z-index: 2;
    }
    #canvasD {
      left: 134px;
      top: 100px;
      width: 420px;
      height: 294px;
      background: #ccccff;
      z-index: 3;
    }
    /* p τομέας στο full view: αρχική θέση left = 134px, αλλά μετατοπίζεται με βάση currentZ */
    #canvasP {
      left: 134px;
      top: 100px;
      width: 252px;
      height: 294px;
      background: #ccffcc;
      z-index: 4;
    }
    /* COLLAPSED VIEW: Θέσεις καμβάδων τομέων */
    body.collapsed #canvasS {
      left: 50px;
      top: 100px;
    }
    body.collapsed #canvasF {
      left: 154px;  /* 134 + 20 */
      top: 190px;   /* 100 + 90 */
      width: 588px;
    }
    body.collapsed #canvasD {
      left: 134px;
      top: 100px;
      width: 420px;
    }
    body.collapsed #canvasP {
      left: 554px;  /* 134 + 420 */
      top: 100px;
      width: 252px;
    }
    /* Ομαδοποίηση: Καμβάδες ομάδων εμφανίζονται όταν currentZ ≥ 122 */
    #canvasS_groups {
      position: absolute;
      top: 58px;  /* έτσι το κάτω άκρο θα είναι στο 58 + 40 = 98px */
      left: 50px;
      width: 82px;
      height: 40px;
      background: #f0f0f0;
      display: none;
      z-index: 11;
    }
    #canvasD_groups {
      position: absolute;
      top: 58px;
      left: 134px; /* θα ενημερωθεί με βάση το canvasD */
      width: 418px;
      height: 40px;
      background: #f0f0f0;
      display: none;
      z-index: 11;
    }
    #canvasP_groups {
      position: absolute;
      top: 58px;
      left: 134px; /* θα ενημερωθεί με βάση το canvasP */
      width: 250px;
      height: 40px;
      background: #f0f0f0;
      display: none;
      z-index: 11;
    }
    /* (Οι παλαιές ετικέτες περιόδων, αν υπάρχουν, δεν τροποποιούνται εδώ) */
    .period-label {
      position: absolute;
      left: 15px;
      font-size: 11px;
      font-weight: bold;
      color: #333;
      background: rgba(200,200,200,0.9);
      padding: 2px 5px;
      border-radius: 3px;
      display: none;
      line-height: 13px;
      z-index: 30;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body class="full">
  <div id="title">Περιοδικός Πίνακας</div>
  
  <!-- Καμβάδες Περιόδων -->
  <div id="canvasPeriods" class="canvas"></div>
  <!-- Καμβάδες Ομάδων -->
  <div id="canvasS_groups" class="canvas"></div>
  <div id="canvasD_groups" class="canvas"></div>
  <div id="canvasP_groups" class="canvas"></div>
  
  <!-- Καμβάδες Τομέων -->
  <div id="canvasS" class="canvas"></div>
  <div id="canvasF" class="canvas"></div>
  <div id="canvasD" class="canvas"></div>
  <div id="canvasP" class="canvas"></div>
  
  <!-- Info Panel -->
  <div id="infoPanel">
    <div id="leftPanel">
      <div id="elementInfo"></div>
      <div id="subshells"></div>
      <div id="shells"></div>
      <div id="outerShell"></div>
    </div>
    <div id="middlePanel">
      <div id="explanation"></div>
      <div id="remarks"></div>
    </div>
  </div>
  
  <!-- Fixed κουμπιά (Δεν μετακινούνται σε κανένα view) -->
  <div id="rightPanel">
    <button id="nextElement">Επόμενο</button>
    <button id="fillAll">Συμπλήρωσε</button>
    <button id="toggleFBlock">Εναλλαγή f-στοιχείων</button>
    <button id="reset">Reset</button>
  </div>
  
  <script>
    // Ενημέρωση θέσης του infoPanel βάσει του view και του πλάτους της οθόνης (W)
    function updateInfoPanelPosition() {
      const infoPanel = document.getElementById('infoPanel');
      const W = window.innerWidth;
      if(document.body.classList.contains('collapsed')){
        // Collapsed view:
        // Ο p τομέας έχει στην collapsed view: left = 554px, width = 252px → δεξιό άκρο = 806px.
        // infoPanel.left = 806 + 42 = 848px.
        // infoPanel.width = W – 806 – 82 = W – 888.
        infoPanel.style.top = "100px";
        infoPanel.style.left = "848px";
        infoPanel.style.width = (W - 888) + "px";
      } else {
        // Full view:
        // infoPanel.top = 500px, left = 20px, width = W – 150 – 60 = W – 210.
        infoPanel.style.top = "500px";
        infoPanel.style.left = "20px";
        infoPanel.style.width = (W - 210) + "px";
      }
    }
  
    // Ενημέρωση θέσεων των καμβάδων τομέων
    function updateCanvasPositions() {
      if(!document.body.classList.contains('collapsed')){
        // Full view:
        // Οι θέσεις εκτός του p είναι σταθερές.
        // Για τον p τομέα μετατοπίζουμε βάσει currentZ.
        if(currentZ >= 21) {
          let base = 134;
          let shift = 0;
          if(currentZ >= 21 && currentZ <= 30) {
            shift = 42 * (currentZ - 20);
          } else if(currentZ >= 31 && currentZ <= 56) {
            shift = 42 * 10;
          } else if(currentZ >= 57 && currentZ <= 70) {
            shift = 42 * 10 + 42 * (currentZ - 56);
          } else if(currentZ > 70) {
            shift = 42 * 10 + 42 * 14;
          }
          document.getElementById('canvasP').style.left = (base + shift) + "px";
        } else {
          document.getElementById('canvasP').style.left = "134px";
        }
      } else {
        // Collapsed view: ορίζουμε τις θέσεις σταθερά
        document.getElementById('canvasS').style.left = "50px";
        document.getElementById('canvasF').style.left = "154px";  // 134+20
        document.getElementById('canvasD').style.left = "134px";
        document.getElementById('canvasP').style.left = "554px";  // 134+420
      }
    }
  
    // Dummy updateInfo για δοκιμή (εμφανίζει το currentZ)
    function updateInfo(z) {
      const elementInfo = document.getElementById('elementInfo');
      elementInfo.innerText = "Επιλεγμένο Z: " + z;
    }
  
    // Δοκιμαστικός μετρητής και handlers για τα κουμπιά
    let currentZ = 0;
    document.getElementById('nextElement').addEventListener('click', () => {
      if(currentZ < 3)
        currentZ = 3;
      else if(currentZ < 118)
        currentZ++;
      else if(currentZ === 118)
        currentZ = 119;
      else if(currentZ === 119)
        currentZ = 120;
      else if(currentZ === 120)
        currentZ = 121;  // Σε αυτό το σημείο εμφανίζονται τα παλιά ονόματα ομάδων (δεύτερη σειρά)
      else if(currentZ === 121)
        currentZ = 122;  // Από εδώ και πάνω εμφανίζονται και οι νέες (πάνω σειρά) μαζί με τα παλιά
      else
        currentZ++;
      updateInfo(currentZ);
      updateCanvasPositions();
      updateInfoPanelPosition();
    });
  
    document.getElementById('fillAll').addEventListener('click', () => {
      currentZ = 122;
      updateInfo(currentZ);
      updateCanvasPositions();
      updateInfoPanelPosition();
    });
  
    document.getElementById('reset').addEventListener('click', () => {
      currentZ = 0;
      document.body.classList.remove('collapsed');
      updateInfo(currentZ);
      updateCanvasPositions();
      updateInfoPanelPosition();
    });
  
    document.getElementById('toggleFBlock').addEventListener('click', () => {
      if(currentZ < 122) return;
      document.body.classList.toggle('collapsed');
      updateCanvasPositions();
      updateInfoPanelPosition();
    });
  
    window.addEventListener('load', () => {
      updateInfoPanelPosition();
      updateCanvasPositions();
    });
    window.addEventListener('resize', () => {
      updateInfoPanelPosition();
      updateCanvasPositions();
    });
  
    // Οι λειτουργίες για τους καμβάδες ομάδων και περιόδων παραμένουν όπως στην προηγούμενη έκδοση:
    function initPeriodsCanvas() {
      if(window.periodsInitialized) return;
      new p5(p => {
        p.setup = () => {
          let canvas = p.createCanvas(40, 292);
          canvas.parent("canvasPeriods");
          p.noStroke();
          p.textAlign(p.CENTER, p.CENTER);
          p.textSize(12);
          p.textStyle(p.BOLD);
          p.background(240);
          const labels = ["1η K", "2η L", "3η M", "4η N", "5η O", "6η P", "7η Q"];
          for (let i = 0; i < labels.length; i++){
            p.fill(240);
            p.rect(0, i * 42, 40, 40);
            p.fill(0);
            p.text(labels[i], 20, i * 42 + 20);
          }
        };
      });
      window.periodsInitialized = true;
    }
  
    function initGroupsCanvases() {
      if(window.groupsInitialized) return;
      // Για s:
      new p5(p => {
        p.setup = () => {
          let canvas = p.createCanvas(82, 40);
          canvas.parent("canvasS_groups");
          p.noStroke();
          p.textAlign(p.CENTER, p.CENTER);
          p.textSize(12);
          p.textStyle(p.BOLD);
          p.background(240);
          // Πάνω σειρά (νέα αριθμήση)
          p.fill(0);
          p.text("1", 20, 10);
          p.text("2", 20 + 42, 10);
          // Δεύτερη σειρά (παλιά ονόματα)
          p.text("IA", 20, 22 + 10);
          p.text("IIA", 20 + 42, 22 + 10);
        };
      });
      // Για d:
      new p5(p => {
        p.setup = () => {
          let canvas = p.createCanvas(418, 40);
          canvas.parent("canvasD_groups");
          p.noStroke();
          p.textAlign(p.CENTER, p.CENTER);
          p.textSize(12);
          p.textStyle(p.BOLD);
          p.background(240);
          // Πάνω σειρά: νέα αριθμήση 3 έως 12
          for(let c = 0; c < 10; c++){
            let x = c * (40 + 2);
            p.fill(240);
            p.rect(x, 0, 40, 20);
            p.fill(0);
            p.text((c+3).toString(), x + 20, 10);
          }
          // Δεύτερη σειρά: παλιά ονόματα
          const oldLabels = ["IIIB","IVB","VB","VIB","VIIB","VIIIB","VIIIB","VIIIB","IB","IIB"];
          for(let c = 0; c < 10; c++){
            let x = c * (40 + 2);
            p.fill(240);
            p.rect(x, 22, 40, 20);
            p.fill(0);
            p.text(oldLabels[c], x + 20, 22 + 10);
          }
        };
      });
      // Για p:
      new p5(p => {
        p.setup = () => {
          let canvas = p.createCanvas(250, 40);
          canvas.parent("canvasP_groups");
          p.noStroke();
          p.textAlign(p.CENTER, p.CENTER);
          p.textSize(12);
          p.textStyle(p.BOLD);
          p.background(240);
          // Πάνω σειρά: νέα αριθμήση 13 έως 18
          for(let c = 0; c < 6; c++){
            let x = c * (40 + 2);
            p.fill(240);
            p.rect(x, 0, 40, 20);
            p.fill(0);
            p.text((c+13).toString(), x + 20, 10);
          }
          // Δεύτερη σειρά: παλιά ονόματα για p
          const oldLabels = ["IIIA","IVA","VA","VIA","VIIA","VIIIA"];
          for(let c = 0; c < 6; c++){
            let x = c * (40 + 2);
            p.fill(240);
            p.rect(x, 22, 40, 20);
            p.fill(0);
            p.text(oldLabels[c], x + 20, 22 + 10);
          }
        };
      });
      window.groupsInitialized = true;
    }
  
    // Κλήση των βασικών λειτουργιών κατά φόρτωση
    (function() {
      loadElements();
    })();
  </script>
</body>
</html>
