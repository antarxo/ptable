<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Περιοδικός Πίνακας – Διορθωμένη Λογική</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f7f7f7; text-align: center; }
    #tableContainer { margin: 20px auto; width: max-content; }
    .rowContainer { display: grid; gap: 2px; margin-bottom: 5px; }
    .element { width: 50px; height: 50px; line-height: 50px; text-align: center;
      font-size: 14px; border: 1px solid #555; background: #ddd; cursor: pointer; }
    .s-block { background: #ffb3b3; } .d-block { background: #b3b3ff; }
    .p-block { background: #b3ffb3; } .f-block { background: #ffd699; }
    #electronConfig { max-width: 600px; margin: 20px auto; padding: 10px;
      border: 2px solid #333; background: #fff; text-align: left; }
    #nextElement { margin: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
  </style>
</head>
<body>
  <button id="nextElement">Επόμενο Στοιχείο</button>
  <div id="tableContainer"></div>
  <div id="electronConfig">Κάντε κλικ σε ένα στοιχείο για λεπτομέρειες</div>

<script>
function getCategory(n) {
  if(n >= 3 && n <= 10) return (n <= 4) ? 's-block' : 'p-block';
  if(n >= 11 && n <= 18) return (n <= 12) ? 's-block' : 'p-block';
  if(n >= 19 && n <= 36) {
    if(n <= 20) return 's-block';
    if(n <= 30) return 'd-block';
    return 'p-block';
  }
  if(n >= 37 && n <= 54) {
    if(n <= 38) return 's-block';
    if(n <= 48) return 'd-block';
    return 'p-block';
  }
  if(n >= 55 && n <= 86) {
    if(n <= 56) return 's-block';
    if(n <= 70) return 'f-block';
    if(n <= 80) return 'd-block';
    return 'p-block';
  }
  if(n >= 87) {
    if(n <= 88) return 's-block';
    if(n <= 102) return 'f-block';
    if(n <= 112) return 'd-block';
    return 'p-block';
  }
  return 'p-block';
}

function createCell(elObj) {
  const cell = document.createElement('div');
  cell.className = `element ${elObj.category}`;
  cell.textContent = elObj.number;
  cell.addEventListener('click', () => {
    document.getElementById('electronConfig').innerHTML = 
      `<strong>Στοιχείο ${elObj.number}:</strong><br>Διαμόρφωση: ...`;
  });
  return cell;
}

const patterns = [
  [{count: 8, shifting: false}],
  [{count: 8, shifting: false}],
  [{count: 2, shifting: false}, {count: 10, shifting: true}, {count: 6, shifting: false}],
  [{count: 2, shifting: false}, {count: 10, shifting: true}, {count: 6, shifting: false}],
  [{count: 2, shifting: false}, {count: 14, shifting: true}, {count: 10, shifting: false}, {count: 6, shifting: false}],
  [{count: 2, shifting: false}, {count: 14, shifting: true}, {count: 10, shifting: false}, {count: 6, shifting: false}]
];

const totals = [8, 8, 18, 18, 32, 32];
const rowsData = [];
for(let i = 0; i < 6; i++) {
  rowsData.push({
    pattern: patterns[i],
    totalCells: totals[i],
    currentSegment: 0,
    countInSegment: 0,
    cells: [],
    insertionIndex: patterns[i][0].count,
    shiftedColumns: 0 // Νέα ιδιότητα για μετατόπιση
  });
}

let globalElementNumber = 3;
let currentRowIndex = 0;

function insertShiftedColumnForRows(rowIndices) {
  rowIndices.forEach(i => {
    const row = rowsData[i];
    const insertPos = 2 + row.shiftedColumns; // Δυναμική θέση βάσει προηγούμενων μετατοπίσεων
    row.cells.splice(insertPos, 0, null);
    row.shiftedColumns++; // Ενημέρωση μετρητή
  });
}

function addElementToCurrentRow() {
  if(currentRowIndex >= 6 || globalElementNumber > 118) {
    document.getElementById('nextElement').disabled = true;
    return;
  }

  const row = rowsData[currentRowIndex];
  const segment = row.pattern[row.currentSegment];
  const elObj = { number: globalElementNumber, category: getCategory(globalElementNumber) };
  const cell = createCell(elObj);

  if(segment.shifting) {
    const group = currentRowIndex < 2 ? 1 : currentRowIndex < 4 ? 2 : 3;
    if(group === 2) insertShiftedColumnForRows([0,1]);
    else if(group === 3) insertShiftedColumnForRows([0,1,2,3]);
    
    row.cells.splice(row.insertionIndex, 0, cell);
    row.insertionIndex++;
  } else {
    row.cells.push(cell);
  }

  globalElementNumber++;
  row.countInSegment++;

  if(row.countInSegment === segment.count) {
    row.currentSegment++;
    row.countInSegment = 0;
    if(row.pattern[row.currentSegment]?.shifting) {
      row.insertionIndex = row.pattern[0].count;
    }
  }

  if(row.cells.length >= row.totalCells) currentRowIndex++;
}

function renderAllRows() {
  const container = document.getElementById('tableContainer');
  container.innerHTML = '';
  rowsData.forEach(row => {
    const rowDiv = document.createElement('div');
    rowDiv.className = 'rowContainer';
    rowDiv.style.gridTemplateColumns = `repeat(${row.cells.length}, 50px)`;
    row.cells.forEach(cell => {
      const div = cell || document.createElement('div');
      if(!cell) {
        div.className = 'element';
        div.style.background = '#fff';
      }
      rowDiv.appendChild(div);
    });
    container.appendChild(rowDiv);
  });
}

document.getElementById('nextElement').addEventListener('click', () => {
  addElementToCurrentRow();
  renderAllRows();
});

renderAllRows();
</script>
</body>
</html>
