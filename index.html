<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Διαδραστική κατασκευή του Περιοδικού Πίνακα</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    #buttonPanel { margin-top: 20px; }
    button { padding: 10px; margin: 5px; font-size: 16px; cursor: pointer; }
    #canvasContainer { margin-top: 20px; display: flex; justify-content: center; }
  </style>
</head>
<body>
  <h1>Διαδραστικός Περιοδικός Πίνακας</h1>
  <div id="canvasContainer">
    <div id="canvasS"></div>
    <div id="canvasP"></div>
    <div id="canvasD"></div>
    <div id="canvasF"></div>
  </div>
  <div id="infoPanel">Επιλέξτε ένα στοιχείο</div>
  <div id="buttonPanel">
    <button id="toggleFBlock">Σύμπτυξη / Ανάπτυξη</button>
    <button id="nextElement">Επόμενο</button>
  </div>

  <script>
    let currentZ = 3;
    const elements = [
      { number: 1, block: 's', name: "Υδρογόνο" },
      { number: 2, block: 's', name: "Ήλιο" },
      { number: 3, block: 'p', name: "Λίθιο" },
      { number: 4, block: 'd', name: "Βηρύλλιο" },
      { number: 5, block: 'f', name: "Βόριο" }
    ];

    function updateInfo(z) {
      const element = elements.find(e => e.number === z);
      if (!element) return;
      document.getElementById('infoPanel').innerText = `Τρέχον στοιχείο: ${element.name} (Ζ=${element.number})`;
    }

    function simulateClickOnCurrentElement() {
      const element = elements.find(e => e.number === currentZ);
      if (!element) return;
      const canvas = document.querySelector(`#canvas${element.block.toUpperCase()} canvas`);
      if (!canvas) return;
      const rect = canvas.getBoundingClientRect();
      const clickX = rect.left + 20;
      const clickY = rect.top + 20;

      // **Εκδοχή 1: Προσπαθούμε με PointerEvent**
      const pointerDown = new PointerEvent('pointerdown', { bubbles: true, cancelable: true, clientX: clickX, clientY: clickY, pointerType: 'mouse' });
      const pointerUp = new PointerEvent('pointerup', { bubbles: true, cancelable: true, clientX: clickX, clientY: clickY, pointerType: 'mouse' });
      canvas.dispatchEvent(pointerDown);
      canvas.dispatchEvent(pointerUp);
    }

    document.getElementById('toggleFBlock').addEventListener('click', function() {
      document.body.classList.toggle('collapsed');
      document.getElementById('toggleFBlock').textContent = document.body.classList.contains('collapsed') ? "Ανάπτυξη" : "Σύμπτυξη";

      requestAnimationFrame(() => {
        // **Εκδοχή 1: Δοκιμή με simulateClickOnCurrentElement()**
        simulateClickOnCurrentElement();

        // **Εκδοχή 2: Fallback (αν το simulateClickOnCurrentElement δεν λειτουργεί, αποσχολιάστε αυτή τη γραμμή)**
        // updateInfo(currentZ);
      });
    });

    document.getElementById('nextElement').addEventListener('click', function() {
      if (currentZ < elements.length) {
        currentZ++;
        updateInfo(currentZ);
      }
    });

    function createCanvasForBlock(block) {
      new p5(function(p) {
        p.setup = function() {
          const canvas = p.createCanvas(80, 80);
          canvas.parent(`canvas${block.toUpperCase()}`);
          p.background(200);
          p.fill(0);
          p.textAlign(p.CENTER, p.CENTER);
          p.textSize(16);
          p.text(block.toUpperCase(), 40, 40);
        };
        p.mouseClicked = function() {
          const element = elements.find(e => e.block === block);
          if (element) {
            currentZ = element.number;
            updateInfo(currentZ);
          }
        };
      });
    }

    ["s", "p", "d", "f"].forEach(createCanvasForBlock);
    updateInfo(currentZ);
  </script>
</body>
</html>
